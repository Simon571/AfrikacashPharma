(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5026],{285:(e,t,r)=>{"use strict";r.d(t,{$:()=>o});var s=r(5155);r(2115);var a=r(9708),n=r(2085),i=r(9434);let c=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function o(e){let{className:t,variant:r,size:n,asChild:o=!1,...d}=e,l=o?a.DX:"button";return(0,s.jsx)(l,{"data-slot":"button",className:(0,i.cn)(c({variant:r,size:n,className:t})),...d})}},3052:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},5127:(e,t,r)=>{"use strict";r.d(t,{A0:()=>i,BF:()=>c,Hj:()=>o,XI:()=>n,nA:()=>l,nd:()=>d});var s=r(5155);r(2115);var a=r(9434);function n(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,s.jsx)("table",{"data-slot":"table",className:(0,a.cn)("w-full caption-bottom text-sm",t),...r})})}function i(e){let{className:t,...r}=e;return(0,s.jsx)("thead",{"data-slot":"table-header",className:(0,a.cn)("[&_tr]:border-b",t),...r})}function c(e){let{className:t,...r}=e;return(0,s.jsx)("tbody",{"data-slot":"table-body",className:(0,a.cn)("[&_tr:last-child]:border-0",t),...r})}function o(e){let{className:t,...r}=e;return(0,s.jsx)("tr",{"data-slot":"table-row",className:(0,a.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...r})}function d(e){let{className:t,...r}=e;return(0,s.jsx)("th",{"data-slot":"table-head",className:(0,a.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r})}function l(e){let{className:t,...r}=e;return(0,s.jsx)("td",{"data-slot":"table-cell",className:(0,a.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r})}},5258:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>v});var s=r(5155),a=r(2115),n=r(6695),i=r(285),c=r(5127),o=r(6126),d=r(6671),l=r(7550);let u=(0,r(9946).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var h=r(6474),m=r(3052),x=r(5695);function v(){let[e,t]=(0,a.useState)([]),[r,v]=(0,a.useState)(!0),[g,f]=(0,a.useState)(new Set),p=(0,x.useRouter)(),b=async()=>{try{v(!0);let e=await fetch("/api/stock-movements?type=ENTRY&grouped=true");if(!e.ok)throw Error("Erreur lors du chargement");let r=await e.json();t(r)}catch(e){d.oR.error(e.message||"Erreur lors du chargement des entr\xe9es")}finally{v(!1)}},j=e.length>0?e.reduce((e,t)=>{let r=t.year;return e[r]||(e[r]=[]),e[r].push(t),e},{}):{},N=Object.keys(j).sort((e,t)=>parseInt(t)-parseInt(e));(0,a.useEffect)(()=>{b()},[]);let y=e=>{let t=new Set(g);t.has(e)?t.delete(e):t.add(e),f(t)},w=e=>new Date(e).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),k=e=>"ENTRY"===e?"Entr\xe9e":e,A=e=>"ENTRY"===e?"default":"secondary";return r?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)(i.$,{variant:"ghost",size:"sm",onClick:()=>p.back(),children:[(0,s.jsx)(l.A,{className:"h-4 w-4 mr-2"}),"Retour"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Historique des Entr\xe9es de Stock"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Consultez toutes les entr\xe9es de stock, organis\xe9es par date."})]})]}),(0,s.jsx)("div",{className:"text-center py-8",children:"Chargement..."})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)(i.$,{variant:"ghost",size:"sm",onClick:()=>p.back(),children:[(0,s.jsx)(l.A,{className:"h-4 w-4 mr-2"}),"Retour"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(u,{className:"h-5 w-5 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Historique des Entr\xe9es de Stock"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Consultez toutes les entr\xe9es de stock, organis\xe9es par date."})]})]})]}),0===e.length?(0,s.jsx)(n.Zp,{children:(0,s.jsx)(n.Wu,{className:"py-8 text-center",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"Aucune entr\xe9e de stock trouv\xe9e."})})}):(0,s.jsx)("div",{className:"space-y-6",children:N.map(e=>(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:e}),j[e].map(e=>{let t="".concat(e.year,"-").concat(e.month),r=g.has(t);return(0,s.jsxs)(n.Zp,{className:"overflow-hidden",children:[(0,s.jsx)(n.aR,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>y(t),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[r?(0,s.jsx)(h.A,{className:"h-4 w-4"}):(0,s.jsx)(m.A,{className:"h-4 w-4"}),(0,s.jsxs)(n.ZB,{className:"text-lg",children:[e.month," ",e.year]})]}),(0,s.jsxs)(o.E,{variant:"outline",children:[e.count," entr\xe9e",e.count>1?"s":"","(s) de stock ce mois-ci."]})]})}),r&&(0,s.jsx)(n.Wu,{className:"pt-0",children:(0,s.jsx)("div",{className:"rounded-md border",children:(0,s.jsxs)(c.XI,{children:[(0,s.jsx)(c.A0,{children:(0,s.jsxs)(c.Hj,{children:[(0,s.jsx)(c.nd,{children:"M\xe9dicament"}),(0,s.jsx)(c.nd,{children:"Type"}),(0,s.jsx)(c.nd,{children:"Quantit\xe9"}),(0,s.jsx)(c.nd,{children:"Stock pr\xe9c\xe9dent"}),(0,s.jsx)(c.nd,{children:"Nouveau stock"}),(0,s.jsx)(c.nd,{children:"Raison"}),(0,s.jsx)(c.nd,{children:"Utilisateur"}),(0,s.jsx)(c.nd,{children:"Date"})]})}),(0,s.jsx)(c.BF,{children:e.corrections.map(e=>(0,s.jsxs)(c.Hj,{children:[(0,s.jsx)(c.nA,{className:"font-medium",children:e.medicationName}),(0,s.jsx)(c.nA,{children:(0,s.jsx)(o.E,{variant:A(e.type),children:k(e.type)})}),(0,s.jsx)(c.nA,{children:(0,s.jsxs)("span",{className:"text-green-600",children:["+",e.quantity]})}),(0,s.jsx)(c.nA,{children:e.previousStock}),(0,s.jsx)(c.nA,{children:e.newStock}),(0,s.jsx)(c.nA,{children:(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:e.reason})}),(0,s.jsx)(c.nA,{children:(0,s.jsx)("span",{className:"text-sm",children:e.userName})}),(0,s.jsx)(c.nA,{children:(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:w(e.createdAt)})})]},e.id))})]})})})]},t)})]},e))})]})}},5354:(e,t,r)=>{Promise.resolve().then(r.bind(r,5258))},5695:(e,t,r)=>{"use strict";var s=r(8999);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},6126:(e,t,r)=>{"use strict";r.d(t,{E:()=>o});var s=r(5155);r(2115);var a=r(9708),n=r(2085),i=r(9434);let c=(0,n.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:r,asChild:n=!1,...o}=e,d=n?a.DX:"span";return(0,s.jsx)(d,{"data-slot":"badge",className:(0,i.cn)(c({variant:r}),t),...o})}},6474:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},6695:(e,t,r)=>{"use strict";r.d(t,{BT:()=>o,Wu:()=>d,ZB:()=>c,Zp:()=>n,aR:()=>i});var s=r(5155);r(2115);var a=r(9434);function n(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...r})}function i(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...r})}function c(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",t),...r})}function o(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",t),...r})}function d(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",t),...r})}},7550:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},9434:(e,t,r)=>{"use strict";r.d(t,{M_:()=>c,cn:()=>n,vv:()=>i});var s=r(2596),a=r(9688);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"CDF",r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],s=new Intl.NumberFormat("fr-CD",{minimumFractionDigits:0,maximumFractionDigits:0}).format(e);if("CDF"===t)return"".concat(s).concat(r?" CDF":"");if("USD"===t){let t=new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e);return"".concat(t).concat(r?" USD":"")}return s}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2400;return e/t}},9946:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var s=r(2115);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),i=e=>{let t=n(e);return t.charAt(0).toUpperCase()+t.slice(1)},c=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},o=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:l="",children:u,iconNode:h,...m}=e;return(0,s.createElement)("svg",{ref:t,...d,width:a,height:a,stroke:r,strokeWidth:i?24*Number(n)/Number(a):n,className:c("lucide",l),...!u&&!o(m)&&{"aria-hidden":"true"},...m},[...h.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let r=(0,s.forwardRef)((r,n)=>{let{className:o,...d}=r;return(0,s.createElement)(l,{ref:n,iconNode:t,className:c("lucide-".concat(a(i(e))),"lucide-".concat(e),o),...d})});return r.displayName=i(e),r}}},e=>{var t=t=>e(e.s=t);e.O(0,[9039,7471,8441,1684,7358],()=>t(5354)),_N_E=e.O()}]);