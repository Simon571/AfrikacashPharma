{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 148, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Public/Documents/AfrikaPharma/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\n\ndeclare global {\n  // allow global `var` declarations\n  \n  var prisma: PrismaClient | undefined;\n}\n\nexport const prisma = global.prisma || new PrismaClient();\n\nif (process.env.NODE_ENV !== 'production') global.prisma = prisma;\n"],"names":[],"mappings":";;;AAAA;;AAQO,MAAM,SAAS,OAAO,MAAM,IAAI,IAAI,6HAAA,CAAA,eAAY;AAEvD,wCAA2C,OAAO,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 161, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Public/Documents/AfrikaPharma/src/lib/auth.ts"],"sourcesContent":["import { NextAuthOptions } from 'next-auth';\nimport CredentialsProvider from 'next-auth/providers/credentials';\nimport { PrismaAdapter } from '@next-auth/prisma-adapter';\nimport { prisma } from '@/lib/prisma';\nimport bcrypt from 'bcryptjs';\n\nexport const authOptions: NextAuthOptions = {\n  // Commenté: L'adapter Prisma peut interférer avec CredentialsProvider\n  // adapter: PrismaAdapter(prisma),\n  providers: [\n    CredentialsProvider({\n      name: 'Credentials',\n      credentials: {\n        username: { label: 'Username', type: 'text' },\n        password: { label: 'Password', type: 'password' },\n      },\n      async authorize(credentials) {\n        console.log('[auth] Tentative de connexion', credentials?.username ?? '(aucun)');\n\n        if (!credentials?.username || !credentials.password) {\n          console.warn('[auth] Identifiants incomplets');\n          return null;\n        }\n\n        try {\n          const user = await prisma.user.findUnique({\n            where: { username: credentials.username },\n          });\n\n          if (!user) {\n            console.warn('[auth] Utilisateur introuvable', credentials.username);\n            return null;\n          }\n\n          const passwordOk = await bcrypt.compare(credentials.password, user.passwordHash);\n          console.log('[auth] Vérification mot de passe', passwordOk ? 'OK' : 'ECHEC');\n\n          if (!passwordOk) {\n            return null;\n          }\n\n          return { id: user.id, name: user.username, role: user.role };\n        } catch (error) {\n          console.error('[auth] Erreur:', error);\n          // Fallback: Utilisateurs par défaut si BD indisponible\n          const DEFAULT_USERS = [\n            { id: 'admin-1', username: 'admin', password: 'Admin123!', role: 'admin' },\n            { id: 'seller-1', username: 'vendeur', password: 'vendeur123', role: 'seller' },\n            { id: 'superadmin-1', username: 'superadmin', password: 'SuperAdmin123!', role: 'admin' }\n          ];\n          \n          const defaultUser = DEFAULT_USERS.find(u => u.username === credentials.username);\n          if (defaultUser && defaultUser.password === credentials.password) {\n            console.log('[auth] Authentification avec utilisateur par défaut');\n            return { id: defaultUser.id, name: defaultUser.username, role: defaultUser.role };\n          }\n          return null;\n        }\n      },\n    }),\n  ],\n  session: {\n    strategy: 'jwt',\n  },\n  callbacks: {\n    async jwt({ token, user }) {\n      if (user) {\n        token.id = user.id;\n        token.role = user.role;\n      }\n      return token;\n    },\n    async session({ session, token }) {\n      if (session.user) {\n        session.user.id = token.id as string;\n        session.user.role = token.role as string;\n      }\n      return session;\n    },\n  },\n  pages: {\n    signIn: '/',\n    error: '/auth/error',\n    signOut: '/',\n  },\n};"],"names":[],"mappings":";;;AACA;AAEA;AACA;;;;AAEO,MAAM,cAA+B;IAC1C,sEAAsE;IACtE,kCAAkC;IAClC,WAAW;QACT,CAAA,GAAA,0JAAA,CAAA,UAAmB,AAAD,EAAE;YAClB,MAAM;YACN,aAAa;gBACX,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAO;gBAC5C,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,QAAQ,GAAG,CAAC,iCAAiC,aAAa,YAAY;gBAEtE,IAAI,CAAC,aAAa,YAAY,CAAC,YAAY,QAAQ,EAAE;oBACnD,QAAQ,IAAI,CAAC;oBACb,OAAO;gBACT;gBAEA,IAAI;oBACF,MAAM,OAAO,MAAM,sHAAA,CAAA,SAAM,CAAC,IAAI,CAAC,UAAU,CAAC;wBACxC,OAAO;4BAAE,UAAU,YAAY,QAAQ;wBAAC;oBAC1C;oBAEA,IAAI,CAAC,MAAM;wBACT,QAAQ,IAAI,CAAC,kCAAkC,YAAY,QAAQ;wBACnE,OAAO;oBACT;oBAEA,MAAM,aAAa,MAAM,mIAAA,CAAA,UAAM,CAAC,OAAO,CAAC,YAAY,QAAQ,EAAE,KAAK,YAAY;oBAC/E,QAAQ,GAAG,CAAC,oCAAoC,aAAa,OAAO;oBAEpE,IAAI,CAAC,YAAY;wBACf,OAAO;oBACT;oBAEA,OAAO;wBAAE,IAAI,KAAK,EAAE;wBAAE,MAAM,KAAK,QAAQ;wBAAE,MAAM,KAAK,IAAI;oBAAC;gBAC7D,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,kBAAkB;oBAChC,uDAAuD;oBACvD,MAAM,gBAAgB;wBACpB;4BAAE,IAAI;4BAAW,UAAU;4BAAS,UAAU;4BAAa,MAAM;wBAAQ;wBACzE;4BAAE,IAAI;4BAAY,UAAU;4BAAW,UAAU;4BAAc,MAAM;wBAAS;wBAC9E;4BAAE,IAAI;4BAAgB,UAAU;4BAAc,UAAU;4BAAkB,MAAM;wBAAQ;qBACzF;oBAED,MAAM,cAAc,cAAc,IAAI,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,YAAY,QAAQ;oBAC/E,IAAI,eAAe,YAAY,QAAQ,KAAK,YAAY,QAAQ,EAAE;wBAChE,QAAQ,GAAG,CAAC;wBACZ,OAAO;4BAAE,IAAI,YAAY,EAAE;4BAAE,MAAM,YAAY,QAAQ;4BAAE,MAAM,YAAY,IAAI;wBAAC;oBAClF;oBACA,OAAO;gBACT;YACF;QACF;KACD;IACD,SAAS;QACP,UAAU;IACZ;IACA,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;gBACR,MAAM,EAAE,GAAG,KAAK,EAAE;gBAClB,MAAM,IAAI,GAAG,KAAK,IAAI;YACxB;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,QAAQ,IAAI,EAAE;gBAChB,QAAQ,IAAI,CAAC,EAAE,GAAG,MAAM,EAAE;gBAC1B,QAAQ,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI;YAChC;YACA,OAAO;QACT;IACF;IACA,OAAO;QACL,QAAQ;QACR,OAAO;QACP,SAAS;IACX;AACF","debugId":null}},
    {"offset": {"line": 280, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Public/Documents/AfrikaPharma/src/app/api/auth/%5B...nextauth%5D/route.ts"],"sourcesContent":["import NextAuth from 'next-auth';\nimport { authOptions } from '@/lib/auth';\n\nconst handler = NextAuth(authOptions);\n\nexport { handler as GET, handler as POST };"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,UAAU,CAAA,GAAA,uIAAA,CAAA,UAAQ,AAAD,EAAE,oHAAA,CAAA,cAAW","debugId":null}}]
}