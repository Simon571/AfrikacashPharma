{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 148, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Public/Documents/AfrikaPharma/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\r\n\r\ndeclare global {\r\n  // eslint-disable-next-line no-var\r\n  var __prismaClient__: PrismaClient | undefined\r\n}\r\n\r\nexport const prisma: PrismaClient = global.__prismaClient__ ?? new PrismaClient()\r\nif (process.env.NODE_ENV !== 'production') global.__prismaClient__ = prisma\r\n"],"names":[],"mappings":";;;AAAA;;AAOO,MAAM,SAAuB,OAAO,gBAAgB,IAAI,IAAI,6HAAA,CAAA,eAAY;AAC/E,wCAA2C,OAAO,gBAAgB,GAAG","debugId":null}},
    {"offset": {"line": 161, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Public/Documents/AfrikaPharma/app/api/auth/%5B...nextauth%5D/route.ts"],"sourcesContent":["import NextAuth from 'next-auth';\r\nimport CredentialsProvider from 'next-auth/providers/credentials';\r\nimport bcrypt from 'bcryptjs';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\n// Utilisateurs par défaut\r\nconst DEFAULT_USERS = [\r\n  { id: 'admin-1', username: 'admin', password: 'Admin123!', role: 'admin' },\r\n  { id: 'seller-1', username: 'vendeur', password: 'vendeur123', role: 'seller' },\r\n  { id: 'superadmin-1', username: 'superadmin', password: 'SuperAdmin123!', role: 'admin' }\r\n];\r\n\r\nconst handler = NextAuth({\r\n  providers: [\r\n    CredentialsProvider({\r\n      name: 'Credentials',\r\n      credentials: {\r\n        username: { label: 'Username', type: 'text' },\r\n        password: { label: 'Password', type: 'password' }\r\n      },\r\n      async authorize(credentials) {\r\n        if (!credentials?.username || !credentials.password) {\r\n          return null;\r\n        }\r\n        \r\n        const inputUsername = credentials.username.trim();\r\n        const inputPassword = String(credentials.password).trim();\r\n        \r\n        try {\r\n          // Essayer Prisma d'abord\r\n          try {\r\n            const user = await Promise.race([\r\n              prisma.user.findUnique({\r\n                where: { username: inputUsername }\r\n              }),\r\n              new Promise((_, reject) => \r\n                setTimeout(() => reject(new Error('Timeout')), 5000)\r\n              )\r\n            ]);\r\n            \r\n            if (user) {\r\n              const passwordOk = await bcrypt.compare(inputPassword, (user as any).passwordHash);\r\n              if (passwordOk) {\r\n                return { \r\n                  id: (user as any).id, \r\n                  name: (user as any).username, \r\n                  email: `${(user as any).username}@pharma.local`,\r\n                  role: (user as any).role \r\n                };\r\n              }\r\n            }\r\n          } catch {\r\n            // Fallback\r\n          }\r\n          \r\n          // Fallback: utilisateurs par défaut\r\n          const defaultUser = DEFAULT_USERS.find(u => u.username === inputUsername);\r\n          if (!defaultUser) return null;\r\n          \r\n          if (defaultUser.password === inputPassword) {\r\n            return { \r\n              id: defaultUser.id, \r\n              name: defaultUser.username,\r\n              email: `${defaultUser.username}@pharma.local`,\r\n              role: defaultUser.role \r\n            };\r\n          }\r\n          \r\n          return null;\r\n        } catch (error) {\r\n          return null;\r\n        }\r\n      }\r\n    })\r\n  ],\r\n  session: { strategy: 'jwt' },\r\n  callbacks: {\r\n    async jwt({ token, user }) {\r\n      if (user) {\r\n        ;(token as any).id = (user as any).id;\r\n        ;(token as any).username = (user as any).name;\r\n        ;(token as any).role = (user as any).role;\r\n      }\r\n      return token;\r\n    },\r\n    async session({ session, token }) {\r\n      if (session.user) {\r\n        ;(session.user as any).id = (token as any).id;\r\n        ;(session.user as any).username = (token as any).username;\r\n        ;(session.user as any).role = (token as any).role;\r\n      }\r\n      return session;\r\n    }\r\n  },\r\n  pages: { signIn: '/login' },\r\n  secret: process.env.NEXTAUTH_SECRET,\r\n  debug: true\r\n});\r\n\r\nexport const GET = handler;\r\nexport const POST = handler;\r\n"],"names":[],"mappings":"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","debugId":null}}]
}