{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Public/Documents/AfrikaPharma/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\n\ndeclare global {\n  // allow global `var` declarations\n  \n  var prisma: PrismaClient | undefined;\n}\n\nexport const prisma = global.prisma || new PrismaClient();\n\nif (process.env.NODE_ENV !== 'production') global.prisma = prisma;\n"],"names":[],"mappings":";;;AAAA;;AAQO,MAAM,SAAS,OAAO,MAAM,IAAI,IAAI,6HAAA,CAAA,eAAY;AAEvD,wCAA2C,OAAO,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Public/Documents/AfrikaPharma/src/lib/actions/exchange-rate.ts"],"sourcesContent":["'use server';\r\n\r\nimport { prisma } from '@/lib/prisma';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\nconst DEFAULT_RATE = 2400; // Taux par d√©faut\r\nconst CURRENCY_KEY = 'USD_CDF';\r\n\r\n/**\r\n * R√©cup√®re le taux de change actuel USD‚ÜíCDF\r\n */\r\nexport async function getExchangeRate() {\r\n  try {\r\n    const client = prisma as unknown as {\r\n      exchangeRate: {\r\n        findUnique: (args: unknown) => Promise<{ id: string; rate: number; updatedAt: Date } | null>;\r\n        create: (args: unknown) => Promise<{ id: string; rate: number; updatedAt: Date }>;\r\n      };\r\n    };\r\n\r\n    const existing = await client.exchangeRate.findUnique({ where: { currency: CURRENCY_KEY } });\r\n    if (existing) {\r\n      return existing;\r\n    }\r\n\r\n    return client.exchangeRate.create({\r\n      data: {\r\n        currency: CURRENCY_KEY,\r\n        rate: DEFAULT_RATE,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    console.error('Erreur lors de la r√©cup√©ration du taux:', error);\r\n    return { id: '', rate: DEFAULT_RATE, currency: CURRENCY_KEY, createdAt: new Date(), updatedAt: new Date() };\r\n  }\r\n}\r\n\r\n/**\r\n * Met √† jour le taux de change et recalcule tous les prix en CDF\r\n */\r\nexport async function updateExchangeRate(newRate: number, updatedBy?: string) {\r\n  try {\r\n    if (!newRate || newRate <= 0) {\r\n      throw new Error('Le taux doit √™tre un nombre positif.');\r\n    }\r\n\r\n    const client = prisma as unknown as {\r\n      exchangeRate: {\r\n        findUnique: (args: unknown) => Promise<{ id: string; rate: number; updatedAt: Date } | null>;\r\n        upsert: (args: unknown) => Promise<{ id: string; rate: number; updatedAt: Date }>;\r\n      };\r\n      medication: {\r\n        findMany: (args: unknown) => Promise<Array<Record<string, unknown>>>;\r\n        update: (args: unknown) => Promise<void>;\r\n      };\r\n      auditLog: {\r\n        create: (args: unknown) => Promise<void>;\r\n      };\r\n    };\r\n\r\n    const existing = await client.exchangeRate.findUnique({\r\n      where: { currency: CURRENCY_KEY },\r\n    });\r\n    const currentRate = existing?.rate ?? DEFAULT_RATE;\r\n\r\n    const exchangeRecord = await client.exchangeRate.upsert({\r\n      where: { currency: CURRENCY_KEY },\r\n      create: {\r\n        currency: CURRENCY_KEY,\r\n        rate: newRate,\r\n      },\r\n      update: {\r\n        rate: newRate,\r\n      },\r\n    });\r\n\r\n    const medications = await client.medication.findMany({\r\n      select: {\r\n        id: true,\r\n        price: true,\r\n        purchasePrice: true,\r\n        priceUsd: true,\r\n        purchasePriceUsd: true,\r\n      },\r\n    });\r\n\r\n    let medicationsUpdated = 0;\r\n    const CHUNK_SIZE = 50;\r\n\r\n    for (let start = 0; start < medications.length; start += CHUNK_SIZE) {\r\n      const slice = medications.slice(start, start + CHUNK_SIZE);\r\n\r\n      const updates = slice.map((medication) => {\r\n        const med = medication as unknown as {\r\n          id: string;\r\n          price: number;\r\n          purchasePrice: number;\r\n          priceUsd?: number | null;\r\n          purchasePriceUsd?: number | null;\r\n        };\r\n\r\n        const baseSalesUsd =\r\n          med.priceUsd && med.priceUsd > 0 ? med.priceUsd : (med.price || 0) / currentRate;\r\n        const basePurchaseUsd =\r\n          med.purchasePriceUsd && med.purchasePriceUsd > 0\r\n            ? med.purchasePriceUsd\r\n            : (med.purchasePrice || 0) / currentRate;\r\n\r\n        return client.medication.update({\r\n          where: { id: med.id },\r\n          data: {\r\n            priceUsd: Math.round(baseSalesUsd * 100) / 100,\r\n            purchasePriceUsd: Math.round(basePurchaseUsd * 100) / 100,\r\n            price: Math.round(baseSalesUsd * newRate * 100) / 100,\r\n            purchasePrice: Math.round(basePurchaseUsd * newRate * 100) / 100,\r\n          },\r\n        });\r\n      });\r\n\r\n      await Promise.all(updates);\r\n      medicationsUpdated += slice.length;\r\n    }\r\n\r\n    if (updatedBy) {\r\n      try {\r\n        await client.auditLog.create({\r\n          data: {\r\n            action: 'exchange_rate_update',\r\n            model: 'ExchangeRate',\r\n            recordId: exchangeRecord.id,\r\n            userId: updatedBy,\r\n            oldValue: existing ? JSON.stringify({ rate: existing.rate }) : null,\r\n            newValue: JSON.stringify({ rate: newRate, medicationsUpdated }),\r\n          },\r\n        });\r\n      } catch (auditError) {\r\n        console.warn(\"Impossible d'enregistrer le journal d'audit:\", auditError);\r\n      }\r\n    }\r\n\r\n    revalidatePath('/admin/inventory');\r\n    revalidatePath('/admin');\r\n    revalidatePath('/(app)/medications');\r\n\r\n    return { ...exchangeRecord, medicationsUpdated };\r\n  } catch (error) {\r\n    console.error('Erreur lors de la mise √† jour du taux:', error);\r\n    throw error;\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 173, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Public/Documents/AfrikaPharma/.next-internal/server/app/admin/exchange-rate/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {getExchangeRate as '004eb8556c154574de50fba8c3810b2bf3fb64eee6'} from 'ACTIONS_MODULE0'\nexport {updateExchangeRate as '60a419c87fe051efc32f9db0e329f4852b0371fb1c'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA","debugId":null}},
    {"offset": {"line": 228, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Public/Documents/AfrikaPharma/src/components/ExchangeRateManager.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const ExchangeRateManager = registerClientReference(\n    function() { throw new Error(\"Attempted to call ExchangeRateManager() from the server but ExchangeRateManager is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ExchangeRateManager.tsx <module evaluation>\",\n    \"ExchangeRateManager\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,sBAAsB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACrD;IAAa,MAAM,IAAI,MAAM;AAAsP,GACnR,wEACA","debugId":null}},
    {"offset": {"line": 242, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Public/Documents/AfrikaPharma/src/components/ExchangeRateManager.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const ExchangeRateManager = registerClientReference(\n    function() { throw new Error(\"Attempted to call ExchangeRateManager() from the server but ExchangeRateManager is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ExchangeRateManager.tsx\",\n    \"ExchangeRateManager\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,sBAAsB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACrD;IAAa,MAAM,IAAI,MAAM;AAAsP,GACnR,oDACA","debugId":null}},
    {"offset": {"line": 256, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 338, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Public/Documents/AfrikaPharma/src/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n\n// Taux de change par d√©faut (utilis√© en secours si aucun taux en base)\nexport const DEFAULT_USD_TO_CDF_RATE = 2400;\n\nexport function formatCurrency(amount: number, currency: 'CDF' | 'USD' = 'CDF', showCurrency = true) {\n  const formattedAmount = new Intl.NumberFormat('fr-CD', {\n    minimumFractionDigits: 0, // Pas de d√©cimales pour les CDF\n    maximumFractionDigits: 0,\n  }).format(amount);\n\n  if (currency === 'CDF') {\n    return `${formattedAmount}${showCurrency ? ' CDF' : ''}`;\n  } else if (currency === 'USD') {\n    // Pour l'affichage en USD, on peut garder 2 d√©cimales\n    const usdFormattedAmount = new Intl.NumberFormat('en-US', {\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2,\n    }).format(amount);\n    return `${usdFormattedAmount}${showCurrency ? ' USD' : ''}`;\n  }\n  return formattedAmount;\n}\n\nexport function convertUsdToCdf(usdAmount: number, rate = DEFAULT_USD_TO_CDF_RATE): number {\n  return usdAmount * rate;\n}\n\nexport function convertCdfToUsd(cdfAmount: number, rate = DEFAULT_USD_TO_CDF_RATE): number {\n  return cdfAmount / rate;\n}"],"names":[],"mappings":";;;;;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,CAAA,GAAA,2JAAA,CAAA,UAAO,AAAD,EAAE,CAAA,GAAA,qIAAA,CAAA,OAAI,AAAD,EAAE;AACtB;AAGO,MAAM,0BAA0B;AAEhC,SAAS,eAAe,MAAc,EAAE,WAA0B,KAAK,EAAE,eAAe,IAAI;IACjG,MAAM,kBAAkB,IAAI,KAAK,YAAY,CAAC,SAAS;QACrD,uBAAuB;QACvB,uBAAuB;IACzB,GAAG,MAAM,CAAC;IAEV,IAAI,aAAa,OAAO;QACtB,OAAO,GAAG,kBAAkB,eAAe,SAAS,IAAI;IAC1D,OAAO,IAAI,aAAa,OAAO;QAC7B,sDAAsD;QACtD,MAAM,qBAAqB,IAAI,KAAK,YAAY,CAAC,SAAS;YACxD,uBAAuB;YACvB,uBAAuB;QACzB,GAAG,MAAM,CAAC;QACV,OAAO,GAAG,qBAAqB,eAAe,SAAS,IAAI;IAC7D;IACA,OAAO;AACT;AAEO,SAAS,gBAAgB,SAAiB,EAAE,OAAO,uBAAuB;IAC/E,OAAO,YAAY;AACrB;AAEO,SAAS,gBAAgB,SAAiB,EAAE,OAAO,uBAAuB;IAC/E,OAAO,YAAY;AACrB","debugId":null}},
    {"offset": {"line": 382, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Public/Documents/AfrikaPharma/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,8JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 479, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Public/Documents/AfrikaPharma/src/lib/auth.ts"],"sourcesContent":["import { NextAuthOptions } from 'next-auth';\nimport CredentialsProvider from 'next-auth/providers/credentials';\nimport { PrismaAdapter } from '@next-auth/prisma-adapter';\nimport { prisma } from '@/lib/prisma';\nimport bcrypt from 'bcryptjs';\n\nexport const authOptions: NextAuthOptions = {\n  // Comment√©: L'adapter Prisma peut interf√©rer avec CredentialsProvider\n  // adapter: PrismaAdapter(prisma),\n  providers: [\n    CredentialsProvider({\n      name: 'Credentials',\n      credentials: {\n        username: { label: 'Username', type: 'text' },\n        password: { label: 'Password', type: 'password' },\n      },\n      async authorize(credentials) {\n        console.log('[auth] Tentative de connexion', credentials?.username ?? '(aucun)');\n\n        if (!credentials?.username || !credentials.password) {\n          console.warn('[auth] Identifiants incomplets');\n          return null;\n        }\n\n        try {\n          const user = await prisma.user.findUnique({\n            where: { username: credentials.username },\n          });\n\n          if (!user) {\n            console.warn('[auth] Utilisateur introuvable', credentials.username);\n            return null;\n          }\n\n          const passwordOk = await bcrypt.compare(credentials.password, user.passwordHash);\n          console.log('[auth] V√©rification mot de passe', passwordOk ? 'OK' : 'ECHEC');\n\n          if (!passwordOk) {\n            return null;\n          }\n\n          return { id: user.id, name: user.username, role: user.role };\n        } catch (error) {\n          console.error('[auth] Erreur:', error);\n          // Fallback: Utilisateurs par d√©faut si BD indisponible\n          const DEFAULT_USERS = [\n            { id: 'admin-1', username: 'admin', password: 'Admin123!', role: 'admin' },\n            { id: 'seller-1', username: 'vendeur', password: 'vendeur123', role: 'seller' },\n            { id: 'superadmin-1', username: 'superadmin', password: 'SuperAdmin123!', role: 'admin' }\n          ];\n          \n          const defaultUser = DEFAULT_USERS.find(u => u.username === credentials.username);\n          if (defaultUser && defaultUser.password === credentials.password) {\n            console.log('[auth] Authentification avec utilisateur par d√©faut');\n            return { id: defaultUser.id, name: defaultUser.username, role: defaultUser.role };\n          }\n          return null;\n        }\n      },\n    }),\n  ],\n  session: {\n    strategy: 'jwt',\n  },\n  callbacks: {\n    async jwt({ token, user }) {\n      if (user) {\n        token.id = user.id;\n        token.role = user.role;\n      }\n      return token;\n    },\n    async session({ session, token }) {\n      if (session.user) {\n        session.user.id = token.id as string;\n        session.user.role = token.role as string;\n      }\n      return session;\n    },\n  },\n  pages: {\n    signIn: '/',\n    error: '/auth/error',\n    signOut: '/',\n  },\n};"],"names":[],"mappings":";;;AACA;AAEA;AACA;;;;AAEO,MAAM,cAA+B;IAC1C,sEAAsE;IACtE,kCAAkC;IAClC,WAAW;QACT,CAAA,GAAA,wJAAA,CAAA,UAAmB,AAAD,EAAE;YAClB,MAAM;YACN,aAAa;gBACX,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAO;gBAC5C,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,QAAQ,GAAG,CAAC,iCAAiC,aAAa,YAAY;gBAEtE,IAAI,CAAC,aAAa,YAAY,CAAC,YAAY,QAAQ,EAAE;oBACnD,QAAQ,IAAI,CAAC;oBACb,OAAO;gBACT;gBAEA,IAAI;oBACF,MAAM,OAAO,MAAM,oHAAA,CAAA,SAAM,CAAC,IAAI,CAAC,UAAU,CAAC;wBACxC,OAAO;4BAAE,UAAU,YAAY,QAAQ;wBAAC;oBAC1C;oBAEA,IAAI,CAAC,MAAM;wBACT,QAAQ,IAAI,CAAC,kCAAkC,YAAY,QAAQ;wBACnE,OAAO;oBACT;oBAEA,MAAM,aAAa,MAAM,iIAAA,CAAA,UAAM,CAAC,OAAO,CAAC,YAAY,QAAQ,EAAE,KAAK,YAAY;oBAC/E,QAAQ,GAAG,CAAC,oCAAoC,aAAa,OAAO;oBAEpE,IAAI,CAAC,YAAY;wBACf,OAAO;oBACT;oBAEA,OAAO;wBAAE,IAAI,KAAK,EAAE;wBAAE,MAAM,KAAK,QAAQ;wBAAE,MAAM,KAAK,IAAI;oBAAC;gBAC7D,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,kBAAkB;oBAChC,uDAAuD;oBACvD,MAAM,gBAAgB;wBACpB;4BAAE,IAAI;4BAAW,UAAU;4BAAS,UAAU;4BAAa,MAAM;wBAAQ;wBACzE;4BAAE,IAAI;4BAAY,UAAU;4BAAW,UAAU;4BAAc,MAAM;wBAAS;wBAC9E;4BAAE,IAAI;4BAAgB,UAAU;4BAAc,UAAU;4BAAkB,MAAM;wBAAQ;qBACzF;oBAED,MAAM,cAAc,cAAc,IAAI,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,YAAY,QAAQ;oBAC/E,IAAI,eAAe,YAAY,QAAQ,KAAK,YAAY,QAAQ,EAAE;wBAChE,QAAQ,GAAG,CAAC;wBACZ,OAAO;4BAAE,IAAI,YAAY,EAAE;4BAAE,MAAM,YAAY,QAAQ;4BAAE,MAAM,YAAY,IAAI;wBAAC;oBAClF;oBACA,OAAO;gBACT;YACF;QACF;KACD;IACD,SAAS;QACP,UAAU;IACZ;IACA,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;gBACR,MAAM,EAAE,GAAG,KAAK,EAAE;gBAClB,MAAM,IAAI,GAAG,KAAK,IAAI;YACxB;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,QAAQ,IAAI,EAAE;gBAChB,QAAQ,IAAI,CAAC,EAAE,GAAG,MAAM,EAAE;gBAC1B,QAAQ,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI;YAChC;YACA,OAAO;QACT;IACF;IACA,OAAO;QACL,QAAQ;QACR,OAAO;QACP,SAAS;IACX;AACF","debugId":null}},
    {"offset": {"line": 598, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Public/Documents/AfrikaPharma/src/app/admin/exchange-rate/page.tsx"],"sourcesContent":["import { ExchangeRateManager } from '@/components/ExchangeRateManager';\r\nimport { getServerSession } from 'next-auth';\r\nimport { redirect } from 'next/navigation';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { authOptions } from '@/lib/auth';\r\n\r\nexport const metadata = {\r\n  title: 'Gestion du Taux de Change | Administration',\r\n  description: 'G√©rez le taux de change USD‚ÜíCDF pour les conversions automatiques des prix',\r\n};\r\n\r\nexport default async function ExchangeRatePage() {\r\n  // V√©rifier les permissions\r\n  const session = await getServerSession(authOptions);\r\n  \r\n  if (!session || session.user?.role !== 'admin') {\r\n    const params = new URLSearchParams({ callbackUrl: '/admin/exchange-rate' });\r\n    redirect(`/login-admin?${params.toString()}`);\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-100 py-8 px-4\">\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        {/* Header */}\r\n        <div className=\"mb-8\">\r\n          <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">\r\n            Gestion du Taux de Change\r\n          </h1>\r\n          <p className=\"text-gray-600\">\r\n            Administrez le taux USD‚ÜíCDF pour la conversion automatique des prix des m√©dicaments\r\n          </p>\r\n        </div>\r\n\r\n        {/* Manager Component */}\r\n        <ExchangeRateManager />\r\n\r\n        {/* Info Cards */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mt-8\">\r\n          {/* Comment √ßa marche */}\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"text-lg\">Comment √ßa marche?</CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-3 text-sm\">\r\n              <div>\r\n                <p className=\"font-semibold text-blue-900 mb-1\">üìå Fonctionnement</p>\r\n                <p className=\"text-gray-700\">\r\n                  Chaque m√©dicament a un prix de r√©f√©rence en USD. Quand vous changez le taux, \r\n                  les prix en CDF se recalculent automatiquement.\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <p className=\"font-semibold text-green-900 mb-1\">‚úÖ Formule</p>\r\n                <p className=\"font-mono bg-green-50 p-2 rounded border border-green-200\">\r\n                  Prix CDF = Prix USD √ó Taux\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <p className=\"font-semibold text-purple-900 mb-1\">‚ö° Instantan√©</p>\r\n                <p className=\"text-gray-700\">\r\n                  Tous les prix sont mises √† jour dans la base de donn√©es imm√©diatement.\r\n                </p>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {/* Bonnes pratiques */}\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"text-lg\">Bonnes pratiques</CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-3 text-sm\">\r\n              <div>\r\n                <p className=\"font-semibold text-blue-900 mb-1\">üîÑ Mise √† jour r√©guli√®re</p>\r\n                <p className=\"text-gray-700\">\r\n                  Mettez √† jour le taux quotidiennement selon le taux officiel du jour.\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <p className=\"font-semibold text-orange-900 mb-1\">üí° V√©rification</p>\r\n                <p className=\"text-gray-700\">\r\n                  V√©rifiez quelques prix apr√®s la mise √† jour pour confirmer le calcul.\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <p className=\"font-semibold text-red-900 mb-1\">‚ö†Ô∏è Attention</p>\r\n                <p className=\"text-gray-700\">\r\n                  Les modifications affectent tous les m√©dicaments. Assurez-vous du taux avant.\r\n                </p>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        {/* D√©tails techniques */}\r\n        <Card className=\"mt-8 bg-gray-50\">\r\n          <CardHeader>\r\n            <CardTitle className=\"text-lg\">D√©tails de l'impl√©mentation</CardTitle>\r\n            <CardDescription>Informations techniques sur le syst√®me de taux de change</CardDescription>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4 text-sm\">\r\n            <div>\r\n              <p className=\"font-semibold mb-2\">üóÑÔ∏è Base de donn√©es</p>\r\n              <ul className=\"list-disc list-inside space-y-1 text-gray-700\">\r\n                <li>Table: <code className=\"bg-white px-2 py-1 rounded border\">ExchangeRate</code></li>\r\n                <li>Devise: <code className=\"bg-white px-2 py-1 rounded border\">USD_CDF</code></li>\r\n                <li>Une seule ligne stock√©e et mise √† jour</li>\r\n              </ul>\r\n            </div>\r\n            <div>\r\n              <p className=\"font-semibold mb-2\">üíæ Stockage des prix</p>\r\n              <ul className=\"list-disc list-inside space-y-1 text-gray-700\">\r\n                <li><code className=\"bg-white px-2 py-1 rounded border\">priceUsd</code> - Prix de vente en USD</li>\r\n                <li><code className=\"bg-white px-2 py-1 rounded border\">price</code> - Prix de vente en CDF (calcul√©)</li>\r\n                <li><code className=\"bg-white px-2 py-1 rounded border\">purchasePriceUsd</code> - Prix d'achat en USD</li>\r\n                <li><code className=\"bg-white px-2 py-1 rounded border\">purchasePrice</code> - Prix d'achat en CDF (calcul√©)</li>\r\n              </ul>\r\n            </div>\r\n            <div>\r\n              <p className=\"font-semibold mb-2\">üîê Permissions</p>\r\n              <p className=\"text-gray-700\">\r\n                Seuls les administrateurs peuvent modifier le taux de change.\r\n              </p>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAAA;AACA;AACA;;;;;;;AAEO,MAAM,WAAW;IACtB,OAAO;IACP,aAAa;AACf;AAEe,eAAe;IAC5B,2BAA2B;IAC3B,MAAM,UAAU,MAAM,CAAA,GAAA,qIAAA,CAAA,mBAAgB,AAAD,EAAE,kHAAA,CAAA,cAAW;IAElD,IAAI,CAAC,WAAW,QAAQ,IAAI,EAAE,SAAS,SAAS;QAC9C,MAAM,SAAS,IAAI,gBAAgB;YAAE,aAAa;QAAuB;QACzE,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD,EAAE,CAAC,aAAa,EAAE,OAAO,QAAQ,IAAI;IAC9C;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BAEb,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAAwC;;;;;;sCAGtD,8OAAC;4BAAE,WAAU;sCAAgB;;;;;;;;;;;;8BAM/B,8OAAC,yIAAA,CAAA,sBAAmB;;;;;8BAGpB,8OAAC;oBAAI,WAAU;;sCAEb,8OAAC,gIAAA,CAAA,OAAI;;8CACH,8OAAC,gIAAA,CAAA,aAAU;8CACT,cAAA,8OAAC,gIAAA,CAAA,YAAS;wCAAC,WAAU;kDAAU;;;;;;;;;;;8CAEjC,8OAAC,gIAAA,CAAA,cAAW;oCAAC,WAAU;;sDACrB,8OAAC;;8DACC,8OAAC;oDAAE,WAAU;8DAAmC;;;;;;8DAChD,8OAAC;oDAAE,WAAU;8DAAgB;;;;;;;;;;;;sDAK/B,8OAAC;;8DACC,8OAAC;oDAAE,WAAU;8DAAoC;;;;;;8DACjD,8OAAC;oDAAE,WAAU;8DAA4D;;;;;;;;;;;;sDAI3E,8OAAC;;8DACC,8OAAC;oDAAE,WAAU;8DAAqC;;;;;;8DAClD,8OAAC;oDAAE,WAAU;8DAAgB;;;;;;;;;;;;;;;;;;;;;;;;sCAQnC,8OAAC,gIAAA,CAAA,OAAI;;8CACH,8OAAC,gIAAA,CAAA,aAAU;8CACT,cAAA,8OAAC,gIAAA,CAAA,YAAS;wCAAC,WAAU;kDAAU;;;;;;;;;;;8CAEjC,8OAAC,gIAAA,CAAA,cAAW;oCAAC,WAAU;;sDACrB,8OAAC;;8DACC,8OAAC;oDAAE,WAAU;8DAAmC;;;;;;8DAChD,8OAAC;oDAAE,WAAU;8DAAgB;;;;;;;;;;;;sDAI/B,8OAAC;;8DACC,8OAAC;oDAAE,WAAU;8DAAqC;;;;;;8DAClD,8OAAC;oDAAE,WAAU;8DAAgB;;;;;;;;;;;;sDAI/B,8OAAC;;8DACC,8OAAC;oDAAE,WAAU;8DAAkC;;;;;;8DAC/C,8OAAC;oDAAE,WAAU;8DAAgB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8BASrC,8OAAC,gIAAA,CAAA,OAAI;oBAAC,WAAU;;sCACd,8OAAC,gIAAA,CAAA,aAAU;;8CACT,8OAAC,gIAAA,CAAA,YAAS;oCAAC,WAAU;8CAAU;;;;;;8CAC/B,8OAAC,gIAAA,CAAA,kBAAe;8CAAC;;;;;;;;;;;;sCAEnB,8OAAC,gIAAA,CAAA,cAAW;4BAAC,WAAU;;8CACrB,8OAAC;;sDACC,8OAAC;4CAAE,WAAU;sDAAqB;;;;;;sDAClC,8OAAC;4CAAG,WAAU;;8DACZ,8OAAC;;wDAAG;sEAAO,8OAAC;4DAAK,WAAU;sEAAoC;;;;;;;;;;;;8DAC/D,8OAAC;;wDAAG;sEAAQ,8OAAC;4DAAK,WAAU;sEAAoC;;;;;;;;;;;;8DAChE,8OAAC;8DAAG;;;;;;;;;;;;;;;;;;8CAGR,8OAAC;;sDACC,8OAAC;4CAAE,WAAU;sDAAqB;;;;;;sDAClC,8OAAC;4CAAG,WAAU;;8DACZ,8OAAC;;sEAAG,8OAAC;4DAAK,WAAU;sEAAoC;;;;;;wDAAe;;;;;;;8DACvE,8OAAC;;sEAAG,8OAAC;4DAAK,WAAU;sEAAoC;;;;;;wDAAY;;;;;;;8DACpE,8OAAC;;sEAAG,8OAAC;4DAAK,WAAU;sEAAoC;;;;;;wDAAuB;;;;;;;8DAC/E,8OAAC;;sEAAG,8OAAC;4DAAK,WAAU;sEAAoC;;;;;;wDAAoB;;;;;;;;;;;;;;;;;;;8CAGhF,8OAAC;;sDACC,8OAAC;4CAAE,WAAU;sDAAqB;;;;;;sDAClC,8OAAC;4CAAE,WAAU;sDAAgB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAS3C","debugId":null}}]
}