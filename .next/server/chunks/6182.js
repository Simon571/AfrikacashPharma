"use strict";exports.id=6182,exports.ids=[6182],exports.modules={163:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"unstable_rethrow",{enumerable:!0,get:function(){return n}});let n=r(71042).unstable_rethrow;("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},10974:(e,t,r)=>{r.d(t,{cn:()=>o,kI:()=>u,vv:()=>i});var n=r(75986),a=r(8974);function o(...e){return(0,a.QP)((0,n.$)(e))}let u=2400;function i(e,t="CDF",r=!0){let n=new Intl.NumberFormat("fr-CD",{minimumFractionDigits:0,maximumFractionDigits:0}).format(e);if("CDF"===t)return`${n}${r?" CDF":""}`;if("USD"===t){let t=new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e);return`${t}${r?" USD":""}`}return n}},12269:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},19854:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var n={};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o.default}});var a=r(12269);Object.keys(a).forEach(function(e){!("default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(n,e))&&(e in t&&t[e]===a[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}}))});var o=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=u(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&({}).hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}(r(35426));function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(u=function(e){return e?r:t})(e)}Object.keys(o).forEach(function(e){!("default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(n,e))&&(e in t&&t[e]===o[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}}))})},31183:(e,t,r)=>{r.d(t,{z:()=>a});var n=r(96330);let a=global.prisma||new n.PrismaClient},39916:(e,t,r)=>{var n=r(97576);r.o(n,"redirect")&&r.d(t,{redirect:function(){return n.redirect}})},41862:(e,t,r)=>{r.d(t,{A:()=>n});let n=(0,r(62688).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},46631:(e,t,r)=>{r.r(t),r.d(t,{"00478848fd4b16ead1f2ed97dee1a9f8aee3916687":()=>d,"60fd4bc4e57810767a9c95e2227803694b889db0a2":()=>c});var n=r(91199);r(42087);var a=r(70664),o=r(7944),u=r(33331);let i="USD_CDF";async function d(){try{let e=a.z,t=await e.exchangeRate.findUnique({where:{currency:i}});if(t)return t;return e.exchangeRate.create({data:{currency:i,rate:2400}})}catch(e){return console.error("Erreur lors de la r\xe9cup\xe9ration du taux:",e),{id:"",rate:2400,currency:i,createdAt:new Date,updatedAt:new Date}}}async function c(e,t){try{if(!e||e<=0)throw Error("Le taux doit \xeatre un nombre positif.");let r=a.z,n=await r.exchangeRate.findUnique({where:{currency:i}}),u=n?.rate??2400,d=await r.exchangeRate.upsert({where:{currency:i},create:{currency:i,rate:e},update:{rate:e}}),c=await r.medication.findMany({select:{id:!0,price:!0,purchasePrice:!0,priceUsd:!0,purchasePriceUsd:!0}}),l=0;for(let t=0;t<c.length;t+=50){let n=c.slice(t,t+50),a=n.map(t=>{let n=t.priceUsd&&t.priceUsd>0?t.priceUsd:(t.price||0)/u,a=t.purchasePriceUsd&&t.purchasePriceUsd>0?t.purchasePriceUsd:(t.purchasePrice||0)/u;return r.medication.update({where:{id:t.id},data:{priceUsd:Math.round(100*n)/100,purchasePriceUsd:Math.round(100*a)/100,price:Math.round(n*e*100)/100,purchasePrice:Math.round(a*e*100)/100}})});await Promise.all(a),l+=n.length}if(t)try{await r.auditLog.create({data:{action:"exchange_rate_update",model:"ExchangeRate",recordId:d.id,userId:t,oldValue:n?JSON.stringify({rate:n.rate}):null,newValue:JSON.stringify({rate:e,medicationsUpdated:l})}})}catch(e){console.warn("Impossible d'enregistrer le journal d'audit:",e)}return(0,o.revalidatePath)("/admin/inventory"),(0,o.revalidatePath)("/admin"),(0,o.revalidatePath)("/(app)/medications"),{...d,medicationsUpdated:l}}catch(e){throw console.error("Erreur lors de la mise \xe0 jour du taux:",e),e}}(0,u.D)([d,c]),(0,n.A)(d,"00478848fd4b16ead1f2ed97dee1a9f8aee3916687",null),(0,n.A)(c,"60fd4bc4e57810767a9c95e2227803694b889db0a2",null)},48976:(e,t,r)=>{function n(){throw Object.defineProperty(Error("`forbidden()` is experimental and only allowed to be enabled when `experimental.authInterrupts` is enabled."),"__NEXT_ERROR_CODE",{value:"E488",enumerable:!1,configurable:!0})}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"forbidden",{enumerable:!0,get:function(){return n}}),r(8704).HTTP_ERROR_FALLBACK_ERROR_CODE,("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},62765:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"notFound",{enumerable:!0,get:function(){return a}});let n=""+r(8704).HTTP_ERROR_FALLBACK_ERROR_CODE+";404";function a(){let e=Object.defineProperty(Error(n),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});throw e.digest=n,e}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},70440:(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var n=r(31658);let a=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,n.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},70664:(e,t,r)=>{r.d(t,{z:()=>a});var n=r(96330);let a=global.prisma||new n.PrismaClient},70899:(e,t,r)=>{function n(){throw Object.defineProperty(Error("`unauthorized()` is experimental and only allowed to be used when `experimental.authInterrupts` is enabled."),"__NEXT_ERROR_CODE",{value:"E411",enumerable:!1,configurable:!0})}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"unauthorized",{enumerable:!0,get:function(){return n}}),r(8704).HTTP_ERROR_FALLBACK_ERROR_CODE,("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},71042:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"unstable_rethrow",{enumerable:!0,get:function(){return function e(t){if((0,u.isNextRouterError)(t)||(0,o.isBailoutToCSRError)(t)||(0,d.isDynamicServerError)(t)||(0,i.isDynamicPostpone)(t)||(0,a.isPostpone)(t)||(0,n.isHangingPromiseRejectionError)(t))throw t;t instanceof Error&&"cause"in t&&e(t.cause)}}});let n=r(68388),a=r(52637),o=r(51846),u=r(31162),i=r(84971),d=r(98479);("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},74072:(e,t,r)=>{r.d(t,{E:()=>a});var n=r(6475);let a=(0,n.createServerReference)("00478848fd4b16ead1f2ed97dee1a9f8aee3916687",n.callServer,void 0,n.findSourceMapURL,"getExchangeRate")},78963:(e,t,r)=>{r.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>i,Zp:()=>o,aR:()=>u,wL:()=>l});var n=r(37413);r(61120);var a=r(10974);function o({className:e,...t}){return(0,n.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function u({className:e,...t}){return(0,n.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function i({className:e,...t}){return(0,n.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",e),...t})}function d({className:e,...t}){return(0,n.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",e),...t})}function c({className:e,...t}){return(0,n.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",e),...t})}function l({className:e,...t}){return(0,n.jsx)("div",{"data-slot":"card-footer",className:(0,a.cn)("flex items-center px-6 [.border-t]:pt-6",e),...t})}},86897:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{getRedirectError:function(){return u},getRedirectStatusCodeFromError:function(){return f},getRedirectTypeFromError:function(){return l},getURLFromRedirectError:function(){return c},permanentRedirect:function(){return d},redirect:function(){return i}});let n=r(52836),a=r(49026),o=r(19121).actionAsyncStorage;function u(e,t,r){void 0===r&&(r=n.RedirectStatusCode.TemporaryRedirect);let o=Object.defineProperty(Error(a.REDIRECT_ERROR_CODE),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return o.digest=a.REDIRECT_ERROR_CODE+";"+t+";"+e+";"+r+";",o}function i(e,t){var r;throw null!=t||(t=(null==o||null==(r=o.getStore())?void 0:r.isAction)?a.RedirectType.push:a.RedirectType.replace),u(e,t,n.RedirectStatusCode.TemporaryRedirect)}function d(e,t){throw void 0===t&&(t=a.RedirectType.replace),u(e,t,n.RedirectStatusCode.PermanentRedirect)}function c(e){return(0,a.isRedirectError)(e)?e.digest.split(";").slice(2,-2).join(";"):null}function l(e){if(!(0,a.isRedirectError)(e))throw Object.defineProperty(Error("Not a redirect error"),"__NEXT_ERROR_CODE",{value:"E260",enumerable:!1,configurable:!0});return e.digest.split(";",2)[1]}function f(e){if(!(0,a.isRedirectError)(e))throw Object.defineProperty(Error("Not a redirect error"),"__NEXT_ERROR_CODE",{value:"E260",enumerable:!1,configurable:!0});return Number(e.digest.split(";").at(-2))}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},97576:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{ReadonlyURLSearchParams:function(){return l},RedirectType:function(){return a.RedirectType},forbidden:function(){return u.forbidden},notFound:function(){return o.notFound},permanentRedirect:function(){return n.permanentRedirect},redirect:function(){return n.redirect},unauthorized:function(){return i.unauthorized},unstable_rethrow:function(){return d.unstable_rethrow}});let n=r(86897),a=r(49026),o=r(62765),u=r(48976),i=r(70899),d=r(163);class c extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class l extends URLSearchParams{append(){throw new c}delete(){throw new c}set(){throw new c}sort(){throw new c}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)}};