(()=>{var e={};e.id=4714,e.ids=[4714],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21721:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>l.a,__next_app__:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>d});var t=r(65239),a=r(48088),n=r(88170),l=r.n(n),i=r(30893),o={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(s,o);let d={children:["",{children:["(app)",{children:["daily-report",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,86754)),"C:\\Users\\Public\\Documents\\Console Afrikapharma\\AfrikaPharma\\src\\app\\(app)\\daily-report\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,70718)),"C:\\Users\\Public\\Documents\\Console Afrikapharma\\AfrikaPharma\\src\\app\\(app)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"C:\\Users\\Public\\Documents\\Console Afrikapharma\\AfrikaPharma\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["C:\\Users\\Public\\Documents\\Console Afrikapharma\\AfrikaPharma\\src\\app\\(app)\\daily-report\\page.tsx"],p={require:r,loadChunk:()=>Promise.resolve()},u=new t.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(app)/daily-report/page",pathname:"/daily-report",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31624:(e,s,r)=>{Promise.resolve().then(r.bind(r,86754))},33873:e=>{"use strict";e.exports=require("path")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70440:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>a});var t=r(31658);let a=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,t.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},70718:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>a});var t=r(37413);function a({children:e}){return(0,t.jsx)(t.Fragment,{children:e})}},78335:()=>{},79551:e=>{"use strict";e.exports=require("url")},80156:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>h});var t=r(60687),a=r(43210),n=r(82136),l=r(44493),i=r(29523),o=r(89667),d=r(80013),c=r(4780),p=r(28561),u=r(23576),x=r(96474),m=r(52581);function h(){let{data:e}=(0,n.useSession)(),[s,r]=(0,a.useState)(null),[h,g]=(0,a.useState)(null),[j,v]=(0,a.useState)([]),[f,y]=(0,a.useState)(!0),[b,N]=(0,a.useState)(!1),[w,P]=(0,a.useState)(""),[A,S]=(0,a.useState)(""),k=async()=>{try{y(!0),console.log("\uD83D\uDD0D Fetching daily report data...");let e=await fetch("/api/daily-report",{cache:"no-store"});if(console.log("\uD83D\uDCCA Daily report response status:",e.status),e.ok){let s=await e.json();console.log("✅ Daily report data:",s),console.log("\uD83D\uDCCA Sales count:",s?.todaySales?.count),console.log("\uD83D\uDCB0 Sales revenue:",s?.todaySales?.totalRevenue),r(s)}else console.error("❌ Daily report error:",e.status,await e.text()),m.oR.error(`Erreur lors du chargement des rapports (${e.status})`);console.log("\uD83D\uDD0D Fetching sales details...");let s=await fetch("/api/sales?today=true",{cache:"no-store"});if(console.log("\uD83D\uDCCB Sales details response status:",s.status),s.ok){let e=await s.json();console.log("✅ Sales details data:",e),console.log("\uD83D\uDCCB Sales array length:",e?.sales?.length),console.log("\uD83D\uDCCB Sales array:",e?.sales),v(e.sales||[])}else console.error("❌ Sales details error:",s.status,await s.text());console.log("\uD83D\uDD0D Fetching expenses...");let t=await fetch("/api/seller-expenses",{cache:"no-store"});if(console.log("\uD83D\uDCB0 Expenses response status:",t.status),t.ok){let e=await t.json();console.log("✅ Expenses data:",e),g(e)}else console.error("❌ Expenses error:",t.status,await t.text())}catch(e){console.error("❌ Fetch error:",e),m.oR.error("Erreur lors du chargement des donn\xe9es")}finally{y(!1)}},C=async e=>{if(e.preventDefault(),!w.trim()||!A||0>=parseFloat(A))return void m.oR.error("Veuillez remplir tous les champs correctement");try{N(!0);let e=await fetch("/api/seller-expenses",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({description:w,amount:parseFloat(A)})});if(!e.ok){let s=await e.json();throw Error(s.error||"Erreur lors de l'enregistrement")}m.oR.success("D\xe9pense enregistr\xe9e avec succ\xe8s"),P(""),S(""),k()}catch(e){console.error("Erreur:",e),m.oR.error(e.message||"Erreur lors de l'enregistrement")}finally{N(!1)}};if(e?.user?.role!=="seller")return(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-red-600",children:"Acc\xe8s refus\xe9"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Cette page est r\xe9serv\xe9e aux vendeurs."})]})});if(f)return(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsx)("div",{className:"h-32 bg-gray-200 rounded"},s))})]})});let D=s?.todaySales?.totalRevenue||0,R=h?.totalExpenses||0;return(0,t.jsxs)("div",{className:"p-6 space-y-6 bg-gray-50 min-h-screen",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Mon Rapport du Jour"}),(0,t.jsxs)("p",{className:"text-gray-600",children:["Consultez vos ventes et enregistrez vos d\xe9penses pour la journ\xe9e du"," ",new Date().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}),"."]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(l.Zp,{children:[(0,t.jsx)(l.aR,{children:(0,t.jsx)(l.ZB,{children:"R\xe9sum\xe9 de la journ\xe9e"})}),(0,t.jsxs)(l.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-blue-50 rounded-lg",children:[(0,t.jsx)("div",{className:"bg-blue-500 p-3 rounded-lg",children:(0,t.jsx)(p.A,{className:"h-6 w-6 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-blue-600 font-medium",children:"Ventes totales"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:(0,c.vv)(D)})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-orange-50 rounded-lg",children:[(0,t.jsx)("div",{className:"bg-orange-500 p-3 rounded-lg",children:(0,t.jsx)(u.A,{className:"h-6 w-6 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-orange-600 font-medium",children:"D\xe9penses totales"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-orange-900",children:(0,c.vv)(R)})]})]})]})]}),(0,t.jsxs)(l.Zp,{children:[(0,t.jsxs)(l.aR,{children:[(0,t.jsx)(l.ZB,{children:"Enregistrer une nouvelle d\xe9pense"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Ajoutez une d\xe9pense effectu\xe9e aujourd'hui."})]}),(0,t.jsx)(l.Wu,{children:(0,t.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(d.J,{htmlFor:"expense-description",children:"Libell\xe9 de la d\xe9pense"}),(0,t.jsx)(o.p,{id:"expense-description",type:"text",placeholder:"ex: Achat d'eau",value:w,onChange:e=>P(e.target.value),required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(d.J,{htmlFor:"expense-amount",children:"Montant (CDF)"}),(0,t.jsx)(o.p,{id:"expense-amount",type:"number",step:"0.01",min:"0",placeholder:"0",value:A,onChange:e=>S(e.target.value),required:!0})]}),(0,t.jsxs)(i.$,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700",disabled:b,children:[(0,t.jsx)(x.A,{className:"h-4 w-4 mr-2"}),b?"Enregistrement...":"Ajouter la d\xe9pense"]})]})})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(l.Zp,{children:[(0,t.jsx)(l.aR,{children:(0,t.jsx)(l.ZB,{children:"D\xe9tail de mes ventes du jour"})}),(0,t.jsx)(l.Wu,{children:0===j.length?(0,t.jsx)("p",{className:"text-gray-500 text-center py-8",children:"Aucune vente enregistr\xe9e aujourd'hui"}):(0,t.jsx)("div",{className:"space-y-3",children:j.map(e=>(0,t.jsxs)("div",{className:"border rounded-lg p-4 bg-gray-50",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"font-medium",children:["Client: ",e.client.name]}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:new Date(e.date).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"font-bold text-green-600",children:(0,c.vv)(e.totalAmount)}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:e.paymentMethod})]})]}),(0,t.jsx)("div",{className:"space-y-1",children:e.items.map((e,s)=>(0,t.jsxs)("p",{className:"text-sm text-gray-700",children:[e.quantity,"x ",e.medication.name," - ",(0,c.vv)(e.priceAtSale*e.quantity)]},s))})]},e.id))})})]}),(0,t.jsxs)(l.Zp,{children:[(0,t.jsx)(l.aR,{children:(0,t.jsx)(l.ZB,{children:"D\xe9tail de mes d\xe9penses du jour"})}),(0,t.jsx)(l.Wu,{children:h&&0!==h.expenses.length?(0,t.jsx)("div",{className:"space-y-3",children:h.expenses.map(e=>(0,t.jsx)("div",{className:"border rounded-lg p-4 bg-gray-50",children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:e.description}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:new Date(e.date).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]}),(0,t.jsx)("p",{className:"font-bold text-red-600",children:(0,c.vv)(e.amount)})]})},e.id))}):(0,t.jsx)("p",{className:"text-gray-500 text-center py-8",children:"Aucune d\xe9pense enregistr\xe9e aujourd'hui"})})]})]})]})}},86754:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>t});let t=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Public\\\\Documents\\\\Console Afrikapharma\\\\AfrikaPharma\\\\src\\\\app\\\\(app)\\\\daily-report\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Public\\Documents\\Console Afrikapharma\\AfrikaPharma\\src\\app\\(app)\\daily-report\\page.tsx","default")},95176:(e,s,r)=>{Promise.resolve().then(r.bind(r,80156))},96474:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(62688).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},96487:()=>{}};var s=require("../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[4243,6915,1422,1658,9853],()=>r(21721));module.exports=t})();