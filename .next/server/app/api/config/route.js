(()=>{var e={};e.id=2164,e.ids=[2164],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},21218:(e,r,t)=>{"use strict";t.d(r,{c$:()=>n,s8:()=>a}),t(61120);let s={appName:"PharmaSuite",version:"1.0.0",isConfigured:!1,pharmacies:[],superAdmin:{maxPharmacies:10,allowMultiTenant:!0}};class i{constructor(){this.configPath=process.env.CONFIG_PATH||"./config/app-config.json",this.config={...s},this.loadConfig()}async loadConfig(){try{{let e=await Promise.resolve().then(t.t.bind(t,29021,23)).then(e=>e.promises),r=await Promise.resolve().then(t.t.bind(t,33873,23));try{let t=r.resolve(this.configPath),i=await e.readFile(t,"utf-8");this.config={...s,...JSON.parse(i)}}catch(e){console.log("Aucun fichier de configuration trouv\xe9, utilisation des valeurs par d\xe9faut")}}}catch(e){console.error("Erreur lors du chargement de la configuration:",e)}}async saveConfig(e){this.config={...this.config,...e};try{{let e=await Promise.resolve().then(t.t.bind(t,29021,23)).then(e=>e.promises),r=await Promise.resolve().then(t.t.bind(t,33873,23)),s=r.resolve(this.configPath),i=r.dirname(s);try{await e.mkdir(i,{recursive:!0})}catch{}await e.writeFile(s,JSON.stringify(this.config,null,2),"utf-8")}}catch(e){throw console.error("Erreur lors de la sauvegarde:",e),e}}getConfig(){return{...this.config}}getPharmacy(e){return this.config.pharmacies.find(r=>r.id===e)}addPharmacy(e){let r=`pharmacy_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,t={...e,id:r};return this.config.pharmacies.push(t),this.config.defaultPharmacy||(this.config.defaultPharmacy=r),r}updatePharmacy(e,r){let t=this.config.pharmacies.findIndex(r=>r.id===e);return -1!==t&&(this.config.pharmacies[t]={...this.config.pharmacies[t],...r},!0)}removePharmacy(e){let r=this.config.pharmacies.findIndex(r=>r.id===e);return -1!==r&&(this.config.pharmacies.splice(r,1),this.config.defaultPharmacy===e&&(this.config.defaultPharmacy=this.config.pharmacies[0]?.id),!0)}isConfigured(){return this.config.isConfigured&&this.config.pharmacies.length>0}markAsConfigured(){this.config.isConfigured=!0}}let a=new i;function n(e){let r=[];return e.name?.trim()||r.push("Le nom de la pharmacie est requis"),e.contact?.email?.includes("@")||r.push("Une adresse email valide est requise"),e.contact?.phone?.trim()||r.push("Un num\xe9ro de t\xe9l\xe9phone est requis"),e.contact?.address?.trim()||r.push("Une adresse est requise"),r}},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},39455:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>w,routeModule:()=>m,serverHooks:()=>x,workAsyncStorage:()=>v,workUnitAsyncStorage:()=>y});var s={};t.r(s),t.d(s,{GET:()=>p,POST:()=>f,PUT:()=>g});var i=t(96559),a=t(48088),n=t(37719),o=t(32190),c=t(21218);let u=require("fs/promises");var l=t.n(u),d=t(33873),h=t.n(d);async function p(){try{let e=c.s8.getConfig();return o.NextResponse.json(e)}catch(e){return console.error("Erreur lors de la r\xe9cup\xe9ration de la configuration:",e),o.NextResponse.json({error:"Erreur lors de la r\xe9cup\xe9ration de la configuration"},{status:500})}}async function f(e){try{let r=await e.json();if(!r||"object"!=typeof r)return o.NextResponse.json({error:"Donn\xe9es de configuration invalides"},{status:400});await c.s8.saveConfig(r);let t=h().resolve("./config/app-config.json"),s=h().dirname(t);try{await l().access(s)}catch{await l().mkdir(s,{recursive:!0})}return await l().writeFile(t,JSON.stringify(r,null,2)),o.NextResponse.json({success:!0,message:"Configuration sauvegard\xe9e avec succ\xe8s"})}catch(e){return console.error("Erreur lors de la sauvegarde de la configuration:",e),o.NextResponse.json({error:"Erreur lors de la sauvegarde de la configuration"},{status:500})}}async function g(e){try{let r=await e.json(),t=c.s8.getConfig(),s={...t,...r,pharmacies:r.pharmacies||t.pharmacies};return await c.s8.saveConfig(s),o.NextResponse.json({success:!0,config:c.s8.getConfig()})}catch(e){return console.error("Erreur lors de la mise \xe0 jour de la configuration:",e),o.NextResponse.json({error:e?.message||"Erreur lors de la mise \xe0 jour de la configuration"},{status:500})}}let m=new i.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/config/route",pathname:"/api/config",filename:"route",bundlePath:"app/api/config/route"},resolvedPagePath:"C:\\Users\\Public\\Documents\\Console Afrikapharma\\app\\api\\config\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:v,workUnitAsyncStorage:y,serverHooks:x}=m;function w(){return(0,n.patchFetch)({workAsyncStorage:v,workUnitAsyncStorage:y})}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[4243,580],()=>t(39455));module.exports=s})();