(()=>{var e={};e.id=8405,e.ids=[8405],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},21218:(e,r,s)=>{"use strict";s.d(r,{c$:()=>n,s8:()=>i}),s(61120);let t={appName:"PharmaSuite",version:"1.0.0",isConfigured:!1,pharmacies:[],superAdmin:{maxPharmacies:10,allowMultiTenant:!0}};class a{constructor(){this.configPath=process.env.CONFIG_PATH||"./config/app-config.json",this.config={...t},this.loadConfig()}async loadConfig(){try{{let e=await Promise.resolve().then(s.t.bind(s,29021,23)).then(e=>e.promises),r=await Promise.resolve().then(s.t.bind(s,33873,23));try{let s=r.resolve(this.configPath),a=await e.readFile(s,"utf-8");this.config={...t,...JSON.parse(a)}}catch(e){console.log("Aucun fichier de configuration trouv\xe9, utilisation des valeurs par d\xe9faut")}}}catch(e){console.error("Erreur lors du chargement de la configuration:",e)}}async saveConfig(e){this.config={...this.config,...e};try{{let e=await Promise.resolve().then(s.t.bind(s,29021,23)).then(e=>e.promises),r=await Promise.resolve().then(s.t.bind(s,33873,23)),t=r.resolve(this.configPath),a=r.dirname(t);try{await e.mkdir(a,{recursive:!0})}catch{}await e.writeFile(t,JSON.stringify(this.config,null,2),"utf-8")}}catch(e){throw console.error("Erreur lors de la sauvegarde:",e),e}}getConfig(){return{...this.config}}getPharmacy(e){return this.config.pharmacies.find(r=>r.id===e)}addPharmacy(e){let r=`pharmacy_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,s={...e,id:r};return this.config.pharmacies.push(s),this.config.defaultPharmacy||(this.config.defaultPharmacy=r),r}updatePharmacy(e,r){let s=this.config.pharmacies.findIndex(r=>r.id===e);return -1!==s&&(this.config.pharmacies[s]={...this.config.pharmacies[s],...r},!0)}removePharmacy(e){let r=this.config.pharmacies.findIndex(r=>r.id===e);return -1!==r&&(this.config.pharmacies.splice(r,1),this.config.defaultPharmacy===e&&(this.config.defaultPharmacy=this.config.pharmacies[0]?.id),!0)}isConfigured(){return this.config.isConfigured&&this.config.pharmacies.length>0}markAsConfigured(){this.config.isConfigured=!0}}let i=new a;function n(e){let r=[];return e.name?.trim()||r.push("Le nom de la pharmacie est requis"),e.contact?.email?.includes("@")||r.push("Une adresse email valide est requise"),e.contact?.phone?.trim()||r.push("Un num\xe9ro de t\xe9l\xe9phone est requis"),e.contact?.address?.trim()||r.push("Une adresse est requise"),r}},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},32053:(e,r,s)=>{"use strict";s.r(r),s.d(r,{patchFetch:()=>g,routeModule:()=>d,serverHooks:()=>f,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>m});var t={};s.r(t),s.d(t,{DELETE:()=>h,GET:()=>u,PUT:()=>p});var a=s(96559),i=s(48088),n=s(37719),o=s(32190),c=s(21218);async function u(e,r){try{let e=await r.params,s=c.s8.getPharmacy(e.id);if(!s)return o.NextResponse.json({error:"Pharmacie non trouv\xe9e"},{status:404});return o.NextResponse.json(s)}catch(e){return console.error("Erreur lors de la r\xe9cup\xe9ration de la pharmacie:",e),o.NextResponse.json({error:"Erreur lors de la r\xe9cup\xe9ration de la pharmacie"},{status:500})}}async function p(e,r){try{let s=await r.params,t=await e.json(),a=(0,c.c$)(t);if(a.length>0)return o.NextResponse.json({error:"Donn\xe9es invalides",details:a},{status:400});if(!c.s8.updatePharmacy(s.id,t))return o.NextResponse.json({error:"Pharmacie non trouv\xe9e"},{status:404});return await c.s8.saveConfig(c.s8.getConfig()),o.NextResponse.json({success:!0,message:"Pharmacie mise \xe0 jour avec succ\xe8s"})}catch(e){return console.error("Erreur lors de la mise \xe0 jour de la pharmacie:",e),o.NextResponse.json({error:"Erreur lors de la mise \xe0 jour de la pharmacie"},{status:500})}}async function h(e,r){try{let e=await r.params;if(!c.s8.removePharmacy(e.id))return o.NextResponse.json({error:"Pharmacie non trouv\xe9e"},{status:404});return await c.s8.saveConfig(c.s8.getConfig()),o.NextResponse.json({success:!0,message:"Pharmacie supprim\xe9e avec succ\xe8s"})}catch(e){return console.error("Erreur lors de la suppression de la pharmacie:",e),o.NextResponse.json({error:"Erreur lors de la suppression de la pharmacie"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/pharmacies/[id]/route",pathname:"/api/pharmacies/[id]",filename:"route",bundlePath:"app/api/pharmacies/[id]/route"},resolvedPagePath:"C:\\Users\\Public\\Documents\\Console Afrikapharma\\app\\api\\pharmacies\\[id]\\route.ts",nextConfigOutput:"",userland:t}),{workAsyncStorage:l,workUnitAsyncStorage:m,serverHooks:f}=d;function g(){return(0,n.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:m})}},33873:e=>{"use strict";e.exports=require("path")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[4243,580],()=>s(32053));module.exports=t})();