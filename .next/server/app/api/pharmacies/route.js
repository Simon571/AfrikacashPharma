(()=>{var e={};e.id=1629,e.ids=[1629],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},21218:(e,r,t)=>{"use strict";t.d(r,{c$:()=>n,s8:()=>i}),t(61120);let s={appName:"PharmaSuite",version:"1.0.0",isConfigured:!1,pharmacies:[],superAdmin:{maxPharmacies:10,allowMultiTenant:!0}};class a{constructor(){this.configPath=process.env.CONFIG_PATH||"./config/app-config.json",this.config={...s},this.loadConfig()}async loadConfig(){try{{let e=await Promise.resolve().then(t.t.bind(t,29021,23)).then(e=>e.promises),r=await Promise.resolve().then(t.t.bind(t,33873,23));try{let t=r.resolve(this.configPath),a=await e.readFile(t,"utf-8");this.config={...s,...JSON.parse(a)}}catch(e){console.log("Aucun fichier de configuration trouv\xe9, utilisation des valeurs par d\xe9faut")}}}catch(e){console.error("Erreur lors du chargement de la configuration:",e)}}async saveConfig(e){this.config={...this.config,...e};try{{let e=await Promise.resolve().then(t.t.bind(t,29021,23)).then(e=>e.promises),r=await Promise.resolve().then(t.t.bind(t,33873,23)),s=r.resolve(this.configPath),a=r.dirname(s);try{await e.mkdir(a,{recursive:!0})}catch{}await e.writeFile(s,JSON.stringify(this.config,null,2),"utf-8")}}catch(e){throw console.error("Erreur lors de la sauvegarde:",e),e}}getConfig(){return{...this.config}}getPharmacy(e){return this.config.pharmacies.find(r=>r.id===e)}addPharmacy(e){let r=`pharmacy_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,t={...e,id:r};return this.config.pharmacies.push(t),this.config.defaultPharmacy||(this.config.defaultPharmacy=r),r}updatePharmacy(e,r){let t=this.config.pharmacies.findIndex(r=>r.id===e);return -1!==t&&(this.config.pharmacies[t]={...this.config.pharmacies[t],...r},!0)}removePharmacy(e){let r=this.config.pharmacies.findIndex(r=>r.id===e);return -1!==r&&(this.config.pharmacies.splice(r,1),this.config.defaultPharmacy===e&&(this.config.defaultPharmacy=this.config.pharmacies[0]?.id),!0)}isConfigured(){return this.config.isConfigured&&this.config.pharmacies.length>0}markAsConfigured(){this.config.isConfigured=!0}}let i=new a;function n(e){let r=[];return e.name?.trim()||r.push("Le nom de la pharmacie est requis"),e.contact?.email?.includes("@")||r.push("Une adresse email valide est requise"),e.contact?.phone?.trim()||r.push("Un num\xe9ro de t\xe9l\xe9phone est requis"),e.contact?.address?.trim()||r.push("Une adresse est requise"),r}},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},67828:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>f,routeModule:()=>p,serverHooks:()=>m,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>l});var s={};t.r(s),t.d(s,{GET:()=>u,POST:()=>h});var a=t(96559),i=t(48088),n=t(37719),o=t(32190),c=t(21218);async function u(){try{let e=c.s8.getConfig();return o.NextResponse.json({pharmacies:e.pharmacies,defaultPharmacy:e.defaultPharmacy})}catch(e){return console.error("Erreur lors de la r\xe9cup\xe9ration des pharmacies:",e),o.NextResponse.json({error:"Erreur lors de la r\xe9cup\xe9ration des pharmacies"},{status:500})}}async function h(e){try{let r=await e.json(),t=(0,c.c$)(r);if(t.length>0)return o.NextResponse.json({error:"Donn\xe9es invalides",details:t},{status:400});let s=c.s8.addPharmacy(r);return await c.s8.saveConfig(c.s8.getConfig()),o.NextResponse.json({success:!0,pharmacyId:s,message:"Pharmacie cr\xe9\xe9e avec succ\xe8s"})}catch(r){console.error("Erreur lors de la cr\xe9ation de la pharmacie:",r);let e=r?.message||"Erreur lors de la cr\xe9ation de la pharmacie";return o.NextResponse.json({error:e},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/pharmacies/route",pathname:"/api/pharmacies",filename:"route",bundlePath:"app/api/pharmacies/route"},resolvedPagePath:"C:\\Users\\Public\\Documents\\Console Afrikapharma\\app\\api\\pharmacies\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:d,workUnitAsyncStorage:l,serverHooks:m}=p;function f(){return(0,n.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:l})}},78335:()=>{},96487:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[4243,580],()=>t(67828));module.exports=s})();