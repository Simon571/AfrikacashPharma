(()=>{var e={};e.id=9543,e.ids=[9543],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},51224:(e,r,s)=>{"use strict";s.r(r),s.d(r,{patchFetch:()=>m,routeModule:()=>p,serverHooks:()=>h,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>x});var t={};s.r(t),s.d(t,{POST:()=>d});var o=s(96559),n=s(48088),a=s(37719),i=s(32190),c=s(96330),u=s(85663);let l=new c.PrismaClient;async function d(e){try{let r;console.log("=== DEBUG LOGIN API ===");let{username:s,password:t,role:o}=await e.json();console.log("Request body:",{username:s,role:o,passwordLength:t?.length});try{await l.$connect(),console.log("✅ Prisma connected")}catch(e){return console.error("❌ Database connection error:",e),i.NextResponse.json({error:"Database connection failed",details:String(e)},{status:500})}try{r=await l.user.findUnique({where:{username:s}}),console.log("User query result:",r?"Found":"Not found"),r&&console.log("User details:",{id:r.id,username:r.username,role:r.role,hasPassword:!!r.passwordHash})}catch(e){return console.error("❌ User query error:",e),i.NextResponse.json({error:"User query failed",details:String(e)},{status:500})}if(!r)return console.log("❌ User not found"),i.NextResponse.json({error:"Utilisateur non trouv\xe9"},{status:401});if(r.role!==o)return console.log("❌ Role mismatch:",{expected:o,actual:r.role}),i.NextResponse.json({error:"R\xf4le incorrect"},{status:401});let n=!1;try{n=await u.Ay.compare(t,r.passwordHash),console.log("Password check result:",n)}catch(e){return console.error("❌ Bcrypt error:",e),i.NextResponse.json({error:"Password verification failed",details:String(e)},{status:500})}if(!n)return console.log("❌ Invalid password"),i.NextResponse.json({error:"Mot de passe incorrect"},{status:401});return console.log("✅ Authentication successful"),i.NextResponse.json({success:!0,user:{id:r.id,username:r.username,role:r.role},redirectUrl:"admin"===o?"/admin-dashboard":"/seller-dashboard"})}catch(e){return console.error("❌ General error:",e),i.NextResponse.json({error:"Erreur serveur g\xe9n\xe9rale",details:String(e),stack:e instanceof Error?e.stack:"No stack"},{status:500})}finally{try{await l.$disconnect()}catch(e){console.error("❌ Disconnect error:",e)}}}let p=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/debug-login/route",pathname:"/api/debug-login",filename:"route",bundlePath:"app/api/debug-login/route"},resolvedPagePath:"C:\\Users\\Public\\Documents\\Console Afrikapharma\\AfrikaPharma\\src\\app\\api\\debug-login\\route.ts",nextConfigOutput:"",userland:t}),{workAsyncStorage:g,workUnitAsyncStorage:x,serverHooks:h}=p;function m(){return(0,a.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:x})}},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96330:e=>{"use strict";e.exports=require("@prisma/client")},96487:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[4243,580,5663],()=>s(51224));module.exports=t})();