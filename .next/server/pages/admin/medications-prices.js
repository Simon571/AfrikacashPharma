"use strict";(()=>{var e={};e.id=4843,e.ids=[3220,4843],e.modules={8732:e=>{e.exports=require("react/jsx-runtime")},15806:e=>{e.exports=require("next-auth/next")},33873:e=>{e.exports=require("path")},40361:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},43197:(e,r,s)=>{s.d(r,{N:()=>d});let t=require("next-auth/providers/credentials");var a=s.n(t);let i=require("bcryptjs");var n=s.n(i),l=s(79943);let o=[{id:"admin-1",username:"admin",password:"Admin123!",role:"admin"},{id:"seller-1",username:"vendeur",password:"vendeur123",role:"seller"},{id:"superadmin-1",username:"superadmin",password:"SuperAdmin123!",role:"admin"}],d={providers:[a()({name:"Credentials",credentials:{username:{label:"Username",type:"text"},password:{label:"Password",type:"password"}},async authorize(e){if(console.log("\uD83D\uDD10 authorize() appel\xe9 avec credentials:",{username:e?.username,password:e?.password?"***":"undefined"}),!e?.username||!e.password)return console.log("❌ Credentials manquants"),null;let r=e.username.trim(),s=String(e.password).trim();try{try{console.log("\uD83D\uDD0D Recherche de l'utilisateur dans Prisma:",r);let e=await Promise.race([l.z.user.findUnique({where:{username:r}}),new Promise((e,r)=>setTimeout(()=>r(Error("Timeout BD")),5e3))]);if(e){console.log("✅ Utilisateur trouv\xe9 dans Prisma");let r=await n().compare(s,e.passwordHash);if(console.log("\uD83D\uDD11 V\xe9rification du mot de passe Prisma:",r?"✅ OK":"❌ FAIL"),r){let r={id:e.id,name:e.username,role:e.role};return console.log("✅ Authentification Prisma r\xe9ussie"),r}}else console.log("ℹ️ Utilisateur non trouv\xe9 dans Prisma, essai des utilisateurs par d\xe9faut")}catch(e){console.warn("⚠️ Erreur Prisma, utilisation des utilisateurs par d\xe9faut:",e)}console.log("\uD83D\uDD0D Recherche de l'utilisateur dans les utilisateurs par d\xe9faut");let e=o.find(e=>e.username===r);if(!e)return console.log("❌ Utilisateur non trouv\xe9:",r),null;console.log("✅ Utilisateur trouv\xe9 dans les utilisateurs par d\xe9faut");let t=e.password===s;if(console.log("\uD83D\uDD11 V\xe9rification du mot de passe (direct):",t?"✅ OK":"❌ FAIL"),!t)return console.log("❌ Mot de passe invalide"),null;let a={id:e.id,name:e.username,role:e.role};return console.log("✅ Authentification r\xe9ussie (utilisateur par d\xe9faut)"),a}catch(e){return console.error("❌ Erreur dans authorize():",e),null}}})],session:{strategy:"jwt"},callbacks:{jwt:async({token:e,user:r})=>(r&&(e.id=r.id,e.username=r.name||r.username,e.role=r.role),e),session:async({session:e,token:r})=>(e.user&&(e.user.id=r.id,e.user.username=r.username,e.user.role=r.role),e)},pages:{signIn:"/login"},secret:process.env.NEXTAUTH_SECRET,debug:!0}},79943:(e,r,s)=>{s.d(r,{z:()=>a});var t=s(96330);let a=global.__prismaClient__??new t.PrismaClient},82015:e=>{e.exports=require("react")},85568:(e,r,s)=>{s.r(r),s.d(r,{config:()=>N,default:()=>f,getServerSideProps:()=>w,getStaticPaths:()=>j,getStaticProps:()=>S,reportWebVitals:()=>y,routeModule:()=>D,unstable_getServerProps:()=>q,unstable_getServerSideProps:()=>C,unstable_getStaticParams:()=>A,unstable_getStaticPaths:()=>_,unstable_getStaticProps:()=>M});var t={};s.r(t),s.d(t,{default:()=>v,getServerSideProps:()=>P});var a=s(63885),i=s(80237),n=s(81413),l=s(58548),o=s.n(l),d=s(19380),c=s.n(d),u=s(8732),m=s(15806),p=s(43197),g=s(79943),x=s(49788),h=s.n(x),b=s(77419);function v({medications:e,exchangeRate:r}){return e?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(h(),{children:(0,u.jsx)("title",{children:"Prix des M\xe9dicaments | AfrikaPharma"})}),(0,u.jsx)("div",{className:"min-h-screen bg-gray-100 p-8",children:(0,u.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,u.jsxs)("div",{className:"mb-8",children:[(0,u.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Prix des M\xe9dicaments"}),(0,u.jsx)("p",{className:"text-gray-600",children:"Visualisez les prix en USD et CDF pour tous les m\xe9dicaments"}),(0,u.jsx)("div",{className:"mt-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,u.jsxs)("p",{className:"text-sm text-blue-900",children:[(0,u.jsx)("strong",{children:"Taux actuel:"})," 1 USD = ",r.toLocaleString()," CDF"]})})]}),0===e.length?(0,u.jsx)("div",{className:"bg-white rounded-lg border p-8 text-center",children:(0,u.jsx)("p",{className:"text-gray-500",children:"Aucun m\xe9dicament disponible"})}):(0,u.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,u.jsxs)("div",{className:"bg-white rounded-lg border p-6",children:[(0,u.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:e.name}),(0,u.jsxs)("div",{className:"space-y-2",children:[(0,u.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[(0,u.jsx)("p",{className:"text-xs text-green-600 mb-1",children:"Prix CDF"}),(0,u.jsxs)("p",{className:"text-lg font-semibold text-green-900",children:[e.price?.toLocaleString()," CDF"]})]}),e.purchasePrice&&(0,u.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3",children:[(0,u.jsx)("p",{className:"text-xs text-orange-600 mb-1",children:"Achat CDF"}),(0,u.jsxs)("p",{className:"text-lg font-semibold text-orange-900",children:[e.purchasePrice?.toLocaleString()," CDF"]})]})]})]},e.id))})]})})]}):(0,u.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,u.jsx)(b.A,{className:"h-6 w-6 animate-spin"})})}let P=async e=>{let r=await (0,m.getServerSession)(e.req,e.res,p.N);if(!r)return{redirect:{destination:"/login",permanent:!1}};if(r.user?.role!=="admin")return{notFound:!0};try{let e=2800;try{let r=await g.z.exchangeRate.findUnique({where:{currency:"USD"}});r&&(e=r.rate)}catch(e){console.error("Erreur lors de la r\xe9cup\xe9ration du taux:",e)}return{props:{medications:await g.z.medication.findMany({select:{id:!0,name:!0,price:!0,purchasePrice:!0},orderBy:{name:"asc"},take:100}),exchangeRate:e},revalidate:60}}catch(e){return console.error("Erreur getServerSideProps:",e),{props:{medications:[],exchangeRate:2800},revalidate:60}}},f=(0,n.M)(t,"default"),S=(0,n.M)(t,"getStaticProps"),j=(0,n.M)(t,"getStaticPaths"),w=(0,n.M)(t,"getServerSideProps"),N=(0,n.M)(t,"config"),y=(0,n.M)(t,"reportWebVitals"),M=(0,n.M)(t,"unstable_getStaticProps"),_=(0,n.M)(t,"unstable_getStaticPaths"),A=(0,n.M)(t,"unstable_getStaticParams"),q=(0,n.M)(t,"unstable_getServerProps"),C=(0,n.M)(t,"unstable_getServerSideProps"),D=new a.PagesRouteModule({definition:{kind:i.A.PAGES,page:"/admin/medications-prices",pathname:"/admin/medications-prices",bundlePath:"",filename:""},components:{App:c(),Document:o()},userland:t})},96330:e=>{e.exports=require("@prisma/client")}};var r=require("../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[8548,1803],()=>s(85568));module.exports=t})();